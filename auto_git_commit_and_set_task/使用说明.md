# Git自动提交脚本使用说明

## 文件说明

- `auto_git_commit.bat` - 主要的Git提交脚本
- `setup_scheduled_task.ps1` - 设置定时任务的PowerShell脚本
- `使用说明.md` - 本说明文档

## 功能特性

### 自动Git提交脚本 (`auto_git_commit.bat`)
- ✅ 自动添加所有更改的文件到Git暂存区
- ✅ 自动生成带时间戳的提交信息
- ✅ 自动提交更改到本地仓库
- ✅ 如果配置了远程仓库，会自动推送到远程
- ✅ 智能检测：如果没有更改则不执行提交
- ✅ 错误处理和状态显示
- ✅ 支持手动执行和自动执行模式

### 定时任务设置
- ✅ 每天6:30自动执行
- ✅ 支持开机自启动
- ✅ 可在任务计划程序中手动运行

## 使用方法

### 方法1：手动执行
直接双击 `auto_git_commit.bat` 文件即可手动执行Git提交。

### 方法2：设置定时自动执行

1. **以管理员身份运行PowerShell**
   - 右键点击开始菜单
   - 选择"Windows PowerShell (管理员)"

2. **执行设置脚本**
   ```powershell
   cd "C:\Users\eason\Desktop\script"
   .\setup_scheduled_task.ps1
   ```

3. **确认设置**
   - 脚本会自动创建名为"GitAutoCommit"的任务计划
   - 任务将在每天6:30自动执行

### 方法3：通过任务计划程序管理

1. 打开"任务计划程序"（在开始菜单搜索"任务计划程序"）
2. 在左侧选择"任务计划程序库"
3. 找到"GitAutoCommit"任务
4. 可以右键选择"运行"手动执行，或"属性"修改设置

## 配置说明

### 修改目标目录
如果需要修改Git提交的目录，请编辑 `auto_git_commit.bat` 文件中的这一行：
```batch
set "TARGET_DIR=D:\frontend\my-journal-planning"
```

### 修改执行时间
如果需要修改执行时间，可以：
1. 在任务计划程序中修改现有任务
2. 或者删除现有任务后重新运行设置脚本（修改PowerShell脚本中的时间）

## 删除定时任务

如果需要删除定时任务，可以：

1. **通过PowerShell删除**
   ```powershell
   .\setup_scheduled_task.ps1 -Remove
   ```

2. **通过任务计划程序删除**
   - 打开任务计划程序
   - 找到"GitAutoCommit"任务
   - 右键选择"删除"

## 注意事项

1. **Git仓库要求**
   - 目标目录必须是Git仓库（包含.git文件夹）
   - 如果目录不是Git仓库，脚本会提示错误

2. **远程仓库**
   - 如果配置了远程仓库，脚本会自动推送
   - 如果没有配置远程仓库，脚本会跳过推送步骤

3. **权限要求**
   - 设置定时任务需要管理员权限
   - 手动执行脚本不需要特殊权限

4. **网络要求**
   - 推送操作需要网络连接
   - 如果网络不可用，推送会失败但本地提交仍会成功

## 故障排除

### 常见问题

1. **"目录不存在"错误**
   - 检查 `TARGET_DIR` 路径是否正确
   - 确保目录存在且有访问权限

2. **"不是Git仓库"错误**
   - 在目标目录中运行 `git init` 初始化Git仓库

3. **"Git add失败"错误**
   - 检查Git是否正确安装
   - 确保有文件修改权限

4. **任务计划程序无法执行**
   - 检查脚本路径是否正确
   - 确保以管理员权限创建了任务

### 日志查看

脚本执行时会显示详细的执行信息，包括：
- 当前操作目录
- Git操作状态
- 提交信息
- 错误信息（如果有）

## 自定义配置

你可以根据需要修改以下内容：

1. **提交信息格式** - 修改 `COMMIT_MSG` 变量
2. **目标目录** - 修改 `TARGET_DIR` 变量
3. **执行时间** - 修改PowerShell脚本中的触发器时间
4. **任务名称** - 修改PowerShell脚本中的 `$TaskName` 变量
